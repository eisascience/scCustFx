% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GSEA.R
\name{run_GSEA_from_signature}
\alias{run_GSEA_from_signature}
\title{Run GSEA from a DE Results Data Frame and a Gene Signature}
\usage{
run_GSEA_from_signature(
  de_df,
  signature_df,
  minGSSize = 5,
  maxGSSize = 500,
  pvalueCutoff = 0.05
)
}
\arguments{
\item{de_df}{A data frame containing DE results with at least two columns: 
\code{gene} (gene symbol) and \code{log2FoldChange} (log-fold change values).}

\item{signature_df}{A data frame containing the gene signature. It must include 
at least the columns \code{SYMBOL} (gene symbol) and \code{signcon} (a numeric 
value where positive indicates up-regulation and negative indicates down-regulation).}

\item{minGSSize}{An integer specifying the minimum gene set size to test in GSEA. 
Default is \code{5}.}

\item{maxGSSize}{An integer specifying the maximum gene set size to test in GSEA. 
Default is \code{500}.}

\item{pvalueCutoff}{A numeric value defining the p-value cutoff for GSEA significance. 
Default is \code{0.05}.}
}
\value{
A list with two components:
\item{gsea_result}{An object containing the GSEA results from \code{clusterProfiler::GSEA}.}
\item{ranked_genes}{A named vector of log2 fold-change values sorted in decreasing order.}
}
\description{
This function performs Gene Set Enrichment Analysis (GSEA) using a differential 
expression (DE) data frame and a gene signature data frame. The gene signature 
is split into up-regulated and down-regulated gene sets based on the signcon 
column. The function returns both the GSEA results object and a sorted, named 
vector of log2FoldChange values.
}
\details{
The function splits the provided \code{signature_df} into two groups based on 
the \code{signcon} value: genes with \code{signcon > 0} (Signature_Up) and 
genes with \code{signcon < 0} (Signature_Down). It creates a TERM2GENE data frame 
with these two groups, then prepares a ranked gene vector from the \code{de_df} 
(ensuring there are no NA or duplicated entries for gene symbols). Finally, it 
performs GSEA using the \pkg{clusterProfiler} package.
}
\examples{
\dontrun{
# Read in your DE results and signature file
de_df <- read.csv("path/to/DE_results.csv")
signature_df <- read.csv("path/to/signature.csv")

# Run GSEA
results <- run_GSEA_from_signature(de_df, signature_df)

# Access the GSEA result and ranked genes
gsea_result <- results$gsea_result
ranked_genes <- results$ranked_genes

# Plot the enrichment for one gene set
library(enrichplot)
gseaplot2(gsea_result, geneSetID = "Signature_Down", title = "GSEA Plot: Signature_Down")
}

}
