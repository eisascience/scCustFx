% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BulkRNAseq.R
\name{plot_heatmap_DEseq}
\alias{plot_heatmap_DEseq}
\title{Plot a heatmap of differentially expressed genes for a single contrast}
\usage{
plot_heatmap_DEseq(
  contrast_df,
  count_mat,
  meta_df,
  cleanBatch = TRUE,
  VoomTrans = FALSE,
  BatchFeat = NULL,
  gene_meta,
  filter = FALSE,
  padj_thr = 0.05,
  absLog2FC_thr = 0.58
)
}
\arguments{
\item{contrast_df}{A data.frame of DE results with columns:
\describe{
  \item{ensembl_ID}{gene IDs matching rownames of \code{count_mat}}
  \item{log2FoldChange}{numeric log2 fold changes}
  \item{padj}{numeric adjusted p‑values}
  \item{contrast_name}{character string used for the plot title}
}}

\item{count_mat}{Numeric matrix of raw counts (rows=genes, cols=samples).
Row names must match \code{contrast_df$ensembl_ID}, column names match rownames of \code{meta_df}.}

\item{meta_df}{Data.frame of sample metadata; rows must align with cols of \code{count_mat}.
Must include the column named by \code{BatchFeat} for batch removal and optionally \code{PD1status}, \code{seqrun} for annotations.}

\item{cleanBatch}{Logical; if \code{TRUE}, calls \code{limma::removeBatchEffect} on \code{BatchFeat}. Default \code{TRUE}.}

\item{VoomTrans}{Logical; if \code{TRUE}, applies \code{limma::voom} before batch correction. Default \code{FALSE}.}

\item{BatchFeat}{Character; the column name in \code{meta_df} indicating batch. Required when \code{cleanBatch = TRUE}.}

\item{gene_meta}{Data.frame mapping \code{ensembl_ID} (rownames) to final gene names. Must contain column \code{final_GeneName}.}

\item{filter}{Logical; if \code{TRUE}, DEGs are filtered by \code{padj} and \code{absLog2FC}. Default \code{FALSE}.}

\item{padj_thr}{Numeric cutoff for adjusted p‑value when \code{filter=TRUE}. Default \code{0.05}.}

\item{absLog2FC_thr}{Numeric cutoff for absolute log2 fold‑change when \code{filter=TRUE}. Default \code{0.58}.}
}
\value{
Invisibly returns the \code{pheatmap} object.
}
\description{
This function selects DEGs from a contrast result, optionally
applies voom transformation and batch correction, then displays a
z‑scored heatmap of expression across samples.
}
