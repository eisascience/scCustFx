% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/SimData_pVL_SIV_ARTv2.R
\name{extract_kinetic_features}
\alias{extract_kinetic_features}
\title{Extract Kinetic Features from Viral Load Time Series}
\usage{
extract_kinetic_features(
  df,
  setpoint_window = 50,
  Oscillation_threshold = 0.5,
  vl_threshold = 3
)
}
\arguments{
\item{df}{A data frame containing two columns: `logVL` (log10 viral load) and `days` (numeric timepoints).}

\item{setpoint_window}{Integer. The number of days from the end of the time series to use for calculating the setpoint (default = 50).}

\item{Oscillation_threshold}{Numeric. The minimum log10 change to consider as a Oscillation or rebound (default = 0.5).}

\item{vl_threshold}{Numeric. The log10 viral load threshold used for calculating persistence and time above threshold (default = 4, corresponding to 10,000 copies/mL).}
}
\value{
A tibble with the following columns:
\describe{
  \item{peak_val}{Maximum log10 viral load (peak value).}
  \item{peak_day}{Day on which the peak viral load occurs.}
  \item{setpoint}{Mean log10 viral load during the last `setpoint_window` days.}
  \item{auc}{Area under the log10 viral load curve (trapezoidal integration).}
  \item{decay_slope}{Linear slope from the peak value to the final value.}
  \item{Oscillations}{Number of post-ART increases in VL > `Oscillation_threshold`.}
  \item{Oscillation_amp}{Average amplitude of VL increases above `Oscillation_threshold`.}
  \item{persistence}{Proportion of timepoints with VL > `vl_threshold`.}
  \item{time_to_peak}{Number of days from first timepoint to peak.}
  \item{initial_growth_rate}{Linear growth rate from first positive VL to peak.}
  \item{variability}{Standard deviation of the log10 viral load across all timepoints.}
  \item{time_above}{Estimated time (in days) spent above the `vl_threshold`, accounting for time intervals.}
  \item{rebounds}{Number of post-peak resurgences in VL > `Oscillation_threshold`.}
}
}
\description{
Computes summary statistics from a time series of log-transformed viral load measurements over time.
Designed for analyzing viral rebound kinetics following ART interruption or similar perturbations.
}
\examples{
# Assuming `df` is a data.frame with columns `logVL` and `days`
extract_kinetic_features(df)

}
