% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Estes_JDE006.R
\name{fit_lm_by_feature}
\alias{fit_lm_by_feature}
\title{Fit a Univariate Linear Model of CopyNumber Against a Single Feature}
\usage{
fit_lm_by_feature(df, xvar, min_n = 20)
}
\arguments{
\item{df}{A `data.frame` or tibble containing at least two numeric columns:
\itemize{
  \item `CopyNumber`: the response variable (numeric).
  \item a predictor column specified by `xvar`.
}}

\item{xvar}{A character scalar giving the name of the predictor variable
to regress `CopyNumber` on.}

\item{min_n}{Integer (default = 20). Minimum number of complete rows required
to attempt model fitting. If fewer rows are available after filtering,
the function returns `NULL` with a warning.}
}
\value{
A fitted `lm` object (linear model) with formula
  `CopyNumber ~ xvar`, or `NULL` if the fit could not be performed.
  The fitted object includes an additional attribute, `"n_used"`, storing
  the number of observations used in the fit.
}
\description{
Customized for Estes SIV/HIV rebound study JDE006
}
\details{
This function automates the process of fitting a simple linear regression
model where the response variable is `CopyNumber` and the predictor is
one specified feature column from the input data frame. It performs basic
cleaning by dropping rows with missing or non-finite values, and skips
fitting if too few usable observations remain.

The function is intended for exploratory screening across multiple
candidate covariates to assess their linear association with `CopyNumber`.
Each call handles one predictor at a time, and returns either a fitted
`lm` object or `NULL` if fitting is not possible. The number of rows used
in the model is attached as an attribute (`n_used`) to the returned model
for downstream auditing.


Steps performed by this function:
\enumerate{
  \item Selects only `CopyNumber` and the specified predictor column.
  \item Removes rows where either variable is missing or non-finite (Inf/NaN).
  \item If fewer than `min_n` rows remain, skips fitting.
  \item Attempts to fit a simple linear model using `lm()`. If fitting fails,
        returns `NULL` with a warning.
}

This design is useful in pipelines where multiple features are screened
programmatically and robust handling of problematic variables is required.
}
\examples{
# Example data
df <- data.frame(
  CopyNumber = rnorm(100, mean = 5),
  TissueArea_mm = runif(100, 1, 10),
  pos_per_mm = rpois(100, 5)
)

# Fit CopyNumber ~ TissueArea_mm
fit <- fit_lm_by_feature(df, "TissueArea_mm")
summary(fit)

# Fit CopyNumber ~ pos_per_mm
fit2 <- fit_lm_by_feature(df, "pos_per_mm")
attr(fit2, "n_used")  # number of rows used

}
\seealso{
[lm()], [audit()] for quickly checking completeness across multiple variables.
}
